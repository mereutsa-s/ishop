(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{475:function(t,e,r){"use strict";var n=r(0);r(12),r(6),r(54),r(102);e.a={data:function(){return{}},mounted:function(){},methods:{phpEncryption:function(data){data=JSON.stringify(data);var t=this.CryptoJS.enc.Hex.parse("0123456470abcdef0123456789abcdef"),e=this.CryptoJS.enc.Hex.parse("abcdef1876343516abcdef9876543210");return this.CryptoJS.AES.encrypt(data,t,{iv:e,padding:this.CryptoJS.pad.ZeroPadding}).toString()},paymentDoneFn:function(t,e,r){var o=this;return Object(n.a)(regeneratorRuntime.mark((function n(){var data;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=o,n.t1=o.langCode,n.t2=o,n.t3=t,n.t4=e,n.t5=r,n.next=8,o.getUserToken();case 8:return n.t6=n.sent,n.t7={id:n.t3,payment_token:n.t4,order_method:n.t5,user_token:n.t6},n.t8=n.t2.phpEncryption.call(n.t2,n.t7),n.t9={data:n.t8},n.t10={lang:n.t1,payload:n.t9},n.next=15,n.t0.paymentDone.call(n.t0,n.t10);case 15:return data=n.sent,o.submitting=!1,200===(null==data?void 0:data.status)?o.$emit("success",t):(o.errorText=data.data.form.join(", "),o.$emit("error",data.data.form.join(", "))),n.abrupt("return",data);case 19:case"end":return n.stop()}}),n)})))()}}}},497:function(t,e,r){"use strict";r.r(e);r(18),r(19),r(22),r(6),r(26),r(17),r(27);var n=r(0),o=r(9),c=(r(12),r(201),r(35),r(7)),d=r(475),l=r(24),m=r(155),f=r(291),y=r(156);function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var x={name:"StripePayment",data:function(){return{stripe:null,card:null,showPopup:!0,loader:!0,submitting:!1,errorText:""}},mixins:[l.a,d.a],watch:{},props:{orderId:{type:Number,default:""},stripeKey:{type:String,default:""},currency:{type:String,default:"USD"},amount:{type:Number,default:0},userName:{type:String,default:""},siteName:{type:String,default:""},userEmail:{type:String,default:""}},components:{PopOver:y.default,AjaxButton:f.default,PriceFormat:m.default},computed:v(v({payBtnText:function(){return this.$t("stripePayment.pay",{amount:this.formattedPrice})},formattedPrice:function(){return this.priceFormat(this.currencyPosition,this.currencyIcon,this.amount,this.setting)}},Object(c.c)("language",["langCode"])),Object(c.c)("common",["currencyIcon","currencyPosition","setting"])),methods:v(v(v({closePopOver:function(){this.$emit("closed"),this.showPopup=!1,this.$destroy(),this.$el.parentNode.removeChild(this.$el)},initPayment:function(){this.stripe=Stripe(this.stripeKey);var t=this.stripe.elements(),style={base:{iconColor:"#666EE8",color:"#31325F",lineHeight:"40px","::placeholder":{color:"#CFD7E0"}}};this.card=t.create("cardNumber",{style:style,showIcon:!0});var e=t.create("cardExpiry",{style:style}),r=t.create("cardCvc",{style:style});this.card.mount("#card-number"),e.mount("#card-expiry"),r.mount("#card-cvc"),this.loader=!1},createStripeToken:function(){var t,e,r=this;this.errorText="",this.submitting=!0,this.stripe.createToken(this.card,{name:null===(t=this.$auth)||void 0===t||null===(e=t.user)||void 0===e?void 0:e.name}).then(function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.error){t.next=5;break}r.submitting=!1,r.errorText=e.error.message,t.next=7;break;case 5:return t.next=7,r.paymentDoneFn(r.orderId,e.token.id,r.orderMethods.STRIPE);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},Object(c.b)("user",["getUserToken"])),Object(c.b)("common",["setToastMessage","setToastError"])),Object(c.b)("order",["paymentDone"])),created:function(){},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=document.createElement("script")).setAttribute("src","https://js.stripe.com/v3/"),document.head.appendChild(r),r.onload=function(){t.initPayment()};case 4:case"end":return e.stop()}}),e)})))()}},O=x,P=r(11),component=Object(P.a)(O,(function(){var t=this,e=t._self._c;return e("div",[e("transition",{attrs:{name:"fade",mode:"out-in"}},[t.showPopup?e("pop-over",{staticClass:"card-popup popup-top-auto",attrs:{"elem-id":"card-pop-over",layer:!0,"outside-click-on":!1},on:{close:t.closePopOver},scopedSlots:t._u([{key:"heading",fn:function(){return[e("div",[e("h3",{staticClass:"color-inherit semi-bold"},[t._v("\n            "+t._s(t.siteName)+"\n          ")]),t._v(" "),e("h6",{staticClass:"color-inherit opacity-8 mb-5"},[t._v("\n            "+t._s(t.$t("stripePayment.bestDeal"))+"\n          ")]),t._v(" "),e("h3",{staticClass:"color-inherit"},[e("price-format",{attrs:{price:t.amount}})],1)])]},proxy:!0},{key:"content",fn:function(){return[e("form",{staticClass:"stripe-form",class:{"opacity-0":t.loader},attrs:{action:"",method:"post",id:"payment-form"}},[e("div",{staticClass:"input-wrap"},[e("label",[t._v("\n              "+t._s(t.$t("stripePayment.creditDebit"))+"\n            ")]),t._v(" "),e("div",{attrs:{id:"card-number"}})]),t._v(" "),e("div",{staticClass:"flex"},[e("div",{staticClass:"input-wrap"},[e("label",[t._v("\n                "+t._s(t.$t("stripePayment.creditExpiry"))+"\n              ")]),t._v(" "),e("div",{attrs:{id:"card-expiry"}})]),t._v(" "),e("div",{staticClass:"input-wrap"},[e("label",[t._v("\n                "+t._s(t.$t("stripePayment.creditCvc"))+"\n              ")]),t._v(" "),e("div",{attrs:{id:"card-cvc"}})])]),t._v(" "),e("div",{attrs:{id:"card-errors",role:"alert"}}),t._v(" "),e("p",{staticClass:"error"},[t._v("\n            "+t._s(t.errorText)+"\n          ")])])]},proxy:!0},{key:"pop-footer",fn:function(){return[e("ajax-button",{staticClass:"primary-btn w-100",attrs:{type:"button","fetching-data":t.submitting,"loading-text":t.$t("stripePayment.placing"),text:t.payBtnText},on:{clicked:t.createStripeToken}})]},proxy:!0}],null,!1,286406990)}):t._e()],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{PriceFormat:r(155).default,AjaxButton:r(291).default,PopOver:r(156).default})}}]);